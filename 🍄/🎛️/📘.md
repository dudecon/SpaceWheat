# ğŸ›ï¸ Codexâ€‘Mini QA Rig (Read This First)

## Mission (What you are here to do)
You are a **QA playtester**. Your job is to **run the rig**, try to **complete the game loop**, and **report bugs or performance issues**. Do not just describe files; execute the steps below and summarize results.

## Canonical Entry Point (Turnâ€‘byâ€‘Turn Live Rig)
- Start listener: `ğŸ„/ğŸ›ï¸/ğŸŸ¢.sh`
- Send a turn: `ğŸ„/ğŸ›ï¸/âœï¸.sh`
- Results log: `${PROJECT_ROOT}/.godot/godot/app_userdata/SpaceWheat - Quantum Farm/rig/results.jsonl`
- Queue log: `${PROJECT_ROOT}/.godot/godot/app_userdata/SpaceWheat - Quantum Farm/rig/queue.jsonl`

This rig lets "Codexâ€‘mini" agents play **one turn at a time** against a **single live game session** (BootManager â†’ PlayerShell â†’ FarmInstrument). You submit JSON turns, the game executes them, and it appends a JSON result line.

## Tools in place
- `Core/Instrumentation/FarmInstrument.gd` exposes methods to open overlays (quests/vocab), read resources, and accept offers. BootManager automatically creates it and stores it on `PlayerShell.farm_instrument`.
- `Tests/qii_*` scripts (probe, gate, vocab, vocab-sequence) now run through the real game loop, call FarmInstrument/QII actions, and emit token logs via `lib_qii.sh`.
- `ğŸ„/ğŸ›ï¸/lib_qii.sh` + `ğŸ„/ğŸ›ï¸/VOCAB_QII.tsv` document the compact command set (e.g., `G3.Q` for explore, `G4.R` for remove vocab) and log timestamps/results for each run.
- `ğŸ„/ğŸ›ï¸/ğŸ§¾/ğŸ”–/` stores `.tok` files that a Codex-mini harness can read to know what happened on each turn; extend them to include outcomes or status codes if needed.

## âœ… Required Steps (Run These â€” Live Rig)
1. **Start the live listener**:
   - `ğŸ„/ğŸ›ï¸/ğŸŸ¢.sh`
2. **Submit turns (one at a time)**:
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":1,"action":"resource_snapshot"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":2,"action":"open_overlay","name":"quests"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":3,"action":"offer_quests"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":4,"action":"active_quests"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":5,"action":"grid_snapshot"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":6,"action":"offer_quests"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":7,"action":"accept_offer","offer_index":0}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":8,"action":"active_quests"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":9,"action":"add_resource","emoji":"ğŸ","amount":1000}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":10,"action":"complete_quest","quest_id":0}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":11,"action":"known_vocab_pairs"}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":12,"action":"inject_vocab","biome":"Village","pair_index":0}'`
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":13,"action":"probe_cycle","biome":"Village"}'`
3. **Read results after each turn**:
   - `tail -n 5 "${PROJECT_ROOT}/.godot/godot/app_userdata/SpaceWheat - Quantum Farm/rig/results.jsonl"`
4. **Stop when done**:
   - `ğŸ„/ğŸ›ï¸/âœï¸.sh '{"turn":99,"action":"stop"}'`
5. **Report QA findings** (required):
   - List errors, warnings, crashes, stalls, or missing UI elements.
   - Note performance issues (slow turns, timeouts).
   - State whether the â€œgame loopâ€ progressed (quests/vocab/resources changed).

## Alternate: Batch Orchestrator (Nonâ€‘interactive QA)
- Orchestrator: `ğŸ„/ğŸ›ï¸/ğŸ¤–ğŸ›ï¸.py`
- Turn plan: `ğŸ„/ğŸ›ï¸/ğŸ§­ğŸ“œ.json`
- Logs: `ğŸ„/ğŸ›ï¸/ğŸ§¾/`
- Tokens: `ğŸ„/ğŸ›ï¸/ğŸ§¾/ğŸ”–/`

Use this if you want **scripted** QA runs rather than turnâ€‘byâ€‘turn play.

## Orchestrator: `ğŸ„/ğŸ›ï¸/ğŸ¤–ğŸ›ï¸.py`

1. `ğŸ„/ğŸ›ï¸/ğŸ§­ğŸ“œ.json` lists sample turns (existing scripts such as `ğŸ¹âš›ï¸` and `ğŸ¹ğŸ§ `) with names/descriptions.
2. Launch the rig via `python ğŸ„/ğŸ›ï¸/ğŸ¤–ğŸ›ï¸.py --plan ğŸ„/ğŸ›ï¸/ğŸ§­ğŸ“œ.json`. The orchestrator runs each turn and *prompts between turns* so a Codex-mini player can stop or keep going, and optionally replay the plan.
3. Each turn captures stdout/stderr and writes a summary JSON (`ğŸ„/ğŸ›ï¸/ğŸ§¾/{turn}_{timestamp}.json`) plus the token logs in `ğŸ„/ğŸ›ï¸/ğŸ§¾/ğŸ”–/`.
4. The emoji wrappers in `ğŸ„/ğŸ›ï¸/*.sh` default to the same token directory (`ğŸ§¾/ğŸ”–`) so direct runs and orchestrated runs land in one place.
5. Use `--dry-run` to print the turn order without executing anything. Use `--no-interactive` to run once without prompts. Use `--timeout` to adjust per-turn timeouts.

## What to extend for Codex-mini (existing tooling)
- Add more liveâ€‘rig actions in `Tests/rig_listener.gd` if the player needs new verbs.
- Enhance the token log format to include `status|emoji|value` so agents can reason about outcomes (e.g., `turn5  SUCCESS  +Vocab Village` or `turn7  FAIL  Need ğŸ`).
- Add a small script that decodes `results.jsonl` into a compact turn summary for downstream analysis.

## Next steps
1. Add richer instrumentation to FarmInstrument so each turn reports resource deltas, quest state, and buffer invalidations.
2. Extend the live rig actions to cover quest accept/turnâ€‘in flows and vocabulary placement.
3. Publish guidelines explaining how to write new turns, decode result logs, and integrate with automation lanes.

Use this rig to have alternate Codex-mini instances experiment with tools/actions in a controlled, turn-by-turn session while keeping logs and documentation in sync. Good luck!
